# UNIX/Linux

## Part 1. Установка OC
___
* Узнать версию Ubuntu, выполнив команду 
`cat /etc/issue`

![1-1](Screen/1-1.png)

## Part 2. Создание пользователя
___
* Вызвать команду для создания пользователя 

![2-1](Screen/2-1.png)

* Добавить нового пользователя в группу 'adm' с помощью команды `sudo usermod -a -G adm user01`, где adm - название группы, а user - имя пользователя

* Ввод команды `cat /etc/passwd` для отображения списка учётных записей системы
 
![2-2](Screen/2-2.png)

## Part 3. Настройка сети ОС
___
* Задать название машины вида user-1  
Используем команду `sudo hostnamectl set-hostname user01`  
Проверяем изменения командой `hostname`

![3-1](Screen/3-1.png)

* Установить временную зону, соответствующую вашему текущему местоположению  
Исползуем команду `sudo timedatectl set-timezone Europe/Moscow`  
Проверяем время командами `timedatectl` или `date`

![3-2](Screen/3-2.png)

* Вывести названия сетевых интерфейсов с помощью консольной команды  
  Для работы с сетевым окружением в ubuntu используется утиллита net-tools.  
  Установим её командой `sudo apt install net-tools`  
  Теперь можно посмотреть нашу сеть командами `ifconfig` `ip link show`

![3-3](Screen/3-3.png)

Интерфейс lo (loopback device) – виртуальный интерфейс, присутствующий по умолчанию в любом Linux.  
Он используется для отладки сетевых программ и запуска серверных приложений на локальной машине.

* Получить ip адрес устройства, на котором вы работаете, от DHCP сервера  
  Сначала сбрасываем старый ip командой `sudo dhclient -r`  
 Получим новый командой `sudo dhclient -v`

  ![3-4](Screen/3-4.png)
  ![3-5](Screen/3-5.png)

  Команда `ip address` применяется для назначения адресов и маски данному интерфейсу.  
-d Заставить dhclient работать как процесс переднего плана.  
DHCP (Dynamic Host Configuration Protocol ) - протокол динамической настройки узла - прикладной протокол, 
позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры,
необходимые для работы в сети TCP/IP. Протокол работает по модели "клиент-сервер"

* Получить внутренний ip - адрес шлюза (gw)  
Вводим команду `ip r`

  ![3-6](Screen/3-6.png)

* Получить внешний ip-адресс  
С помощью команды `wget -O - -q icanhazip.com` узнаём адресс

  ![3-7](Screen/3-7.png)

* Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns 
(использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).  
Вводим команду `sudo vim /etc/netplan/00-installer-config.yaml`

![3-8](Screen/3-8.png)

Сохранить изменения
* Перезагрузить виртуальную машину.
Перезагрузить виртуальную машину c помощью команды `sudo reboot`.

* Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте командой `ip route`

![3-9](Screen/3-9.png)

* Успешно пропинговать удаленные хосты 1.1.1.1 и ya.ru и вставить в отчёт скрин с выводом команды.  
Используем команды `ping -c 4 ya.ru` и `ping -c 4 1.1.1.1` соответсвенно.  
В выводе команды должна быть фраза "0% packet loss".

![3-10](Screen/3-10.png)
![3-11](Screen/3-11.png)

## Part 4. Обновление ОС

* Обновить системные пакеты до последней на момент выполнения задания версии
 Изначально обновляем список репозиториев `sudo apt upgrade`

![4-1](Screen/4-1.png)

Обновляеем версии пакетов командой `sudo apt dist-upgrade`, подтверждаем изменения.
Повторно используем команду `sudo apt dist-upgrade` чтобы убедиться, что обновления отсутсвуют. 

![4-2](Screen/4-2.png)

## Part 5. Использование команды sudo

*    Oбъяснить истинное назначение команды sudo (про то, что это слово - "волшебное", писать не стоит)  
  `sudo` - команда, которая позволяет определенным пользователям выполнять указанные программы с административными привелегиями без ввода пароля root (пользователя с повышенным правом).

* Разрешить пользователю, созданному в Part 2, выполнять команду sudo.  
 Создаём файл нашего пользователя командой `sudo touch /etc/sudoers.d/user01`  
 Открываем его с помощью текстового редактора "nano" командой `sudo nano /etc/sudoers.d/user01`

![5-1](Screen/5-1.png)
Записываем туда следующую строку: `user01 ALL=(ALL:ALL) ALL`   

![5-2](Screen/5-2.png)

Где `user01` ALL=(ALL:ALL) ALL Первое поле показывает имя пользователя, которое правило будет применять к (user01).  
user01 `ALL`=(ALL:ALL) ALL Первое “ALL” означает, что данное правило применяется ко всем хостам.  
user01 ALL=(`ALL`:ALL) ALL Данное “ALL” означает, что пользователь user01 может запускать команды от лица всех пользователей.  
user01 ALL=(ALL:`ALL`) ALL Данное “ALL” означает, что пользователь user01 может запускать команды от лица всех групп.  
user01 ALL=(ALL:ALL) `ALL` Последнее “ALL” означает, что данные правила применяются всем командам.  

Сохраняем изменения, выходим из файла. Заходим под пользователем user01 используя команду `su user01`, проверяем работу sudo командой `sudo apt update`.  

![5-3](Screen/5-3.png)

* Поменять hostname ОС от имени пользователя, созданного в пункте Part 2 (используя sudo)

Устанавливаем имя хоста "user01" используя команду `sudo hostnamectl set-hostname user01`.   
Проверяем изменился hostname или нет командой `hostname`.   

![5-4](Screen/5-4.png)


## Part 6. Установка и настройка службы времени

*Настроить службу автоматической синхронизации времени

- Вывести время, часового пояса, в котором вы сейчас находитесь.
- Вывод следующей команды должен содержать NTPSynchronized=yes:
  timedatectl show
- Вставить скрины с корректным временем и выводом команды в отчёт.  
Вводим команду `time datatectl show`

![6-10](Screen/6-10.png)

## Part 7. Установка и использование текстовых редакторов

* Установить текстовые редакторы VIM (+ любые два по желанию NANO, MCEDIT, JOE и т.д.)

Выбрал и установил VIM, NANO, JOE.  

Для установки VIM требуется команда `sudo apt install vim`.  
Для установки NANO требуется команда `sudo apt install nano`.  
Для установки JOE требуется команда `sudo apt install joe`.  

### VIM

* Создать файл test_X.txt, где X -- название редактора, в котором создан файл. 

![7-2](Screen/7-2.png)

* Напишите в нём свой никнейм, закройте файл с сохранением изменений. 

* Для начала редактирования необходимо нажать клавишу `i`.  
* Для выхода с сохранением нажать клавишу `ESC`, ввести `:wq`.

![7-1](Screen/7-1.png)

* Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, 
* Заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.  
  Для выхода без сохранения VIM нажать клавишу `ESC`, ввести `:q!`.  

![7-8](Screen/7-8.png)

* Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), 
а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.  
  Поиск слова VIM.  
* Нажать клавишу `ESC`, ввести `:/исходное слово`

![7-11](Screen/7-11.png)

Замена слова на другое VIM.  
* Нажать клавишу `ESC`, ввести `:%s/исходное слово/новое слово/g`

![7-12](Screen/7-12.png)

### NANO

* Создать файл test_X.txt, где X -- название редактора, в котором создан файл. 
 
![7-4](Screen/7-4.png)

* Напишите в нём свой никнейм, закройте файл с сохранением изменений
  Для выхода с сохранением зажать клавишу `comtrol` + `X`, подтвердить изменения клавишей `Y`, нажать `Enter`.

![7-3](Screen/7-3.png)

* Используя каждый из трех выбранных редакторов, откройте файл на редактирование, 
* отредактируйте файл, заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.

Для выхода без сохранения зажать клавишу `comtrol` + `X`, отменить изменения клавишей `N`, нажать `Enter`.

![7-9](Screen/7-9.png)

* Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), 
а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.  
Поиск слова  
* Для поиска слова зажать клавишу `comtrol` + `X`, ввести нужное слово в строке Search. Нажать `Enter`. 
На нужном слове будет установлен указатель.

![7-13](Screen/7-13.png)

Замена слова на другое
Для замены слова зажать клавишу `comtrol` + `\`, ввести нужное слово в строке "Search(to replace)". Нажать `Enter`.

![7-14](Screen/7-14.png)

Ввести слово на замену в строке "Replace with". Нажать `Enter`.  

![7-14-1](Screen/7-14-1.png)

Подтвердить замену клавишей `Y`, нажать `Enter`.  

![7-14-2](Screen/7-14-2.png)


### JOE

* Создать файл test_X.txt, где X -- название редактора, в котором создан файл. 

![7-7](Screen/7-7.png)

* Напишите в нём свой никнейм, закройте файл с сохранением изменений
  Для выхода с сохранением нажмите `control` + `K`, а затем клавишу `Q`. После подтвердить изменения клавишей `Y`.

![7-3-1](Screen/7-3-1.png)

* Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, 
* заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.  
  Для выхода без сохранения нажмите `control` + `K`, а затем клавишу `Q`. После отказаться от изменения клавишей `N`.

![7-3-2](Screen/7-3-2.png)

* Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), 
* а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.  
  Поиск слова
  Для поиска слова нужно нажать `control` + `K` и клавишу `F`. Ввести искомое слово, нажать `Enter`.

![7-4-5](Screen/7-4-5.png)

Ещё раз нажать клавишу `Enter`.

![7-4-6](Screen/7-4-6.png)

Курсор мереместиться к искомому слову  

![7-4-7](Screen/7-4-7.png)

Замена слова
* Для замены слова нужно нажать `control` + `K` и клавишу `F`. Ввести искомое слово, нажать `Enter`.

![7-4-1](Screen/7-4-1.png)

Ввести слово для замены в строку  "Чем заменить".  

![7-4-2](Screen/7-4-2.png)

Выделится слово для замены. Нажать клавишу `Y`.

![7-4-3](Screen/7-4-3.png)

Искомое слово заменилось новым.  


![7-4-4](Screen/7-4-4.png)


## Part 8. Установка и базовая настройка сервиса SSHD

* Устанавливаем ssh на рабочую машину с помощью команды 
`sudo apt install openssh-server`  

* При установке SSH-сервер автоматически прописывается в автозагрузку. 
Управлять его запуском, остановкой или перезапуском можно с помощью команд 
`sudo systemctl start|stop|restart ssh`

* Проверить, что служба "ssh.service" работает командой 
`systemctl is-active ssh`

![8-6](Screen/8-6.png)

* Добавляем службу sshd в автозапуск, делаем это с помощью команды
`sudo systemctl enable ssh`

![8-7](Screen/8-7.png)

* Перенастроить службу SSHd на порт 2022
  Чтобы перенастроить службу SSHd на порт 2022 открываем файл "sshd_config" командой `sudo vim /etc/ssh/sshd_config`
* и меняем 22 на 2022.

![8-2](Screen/8-2.png)

* Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.
  В отчёте объяснить значение команды и каждого ключа в ней. Используем команду `ps aux | grep sshd`

![8-1](Screen/8-1.png)

ps - встроенная программа, с помощью которой осуществляется мониторинг активных процессов по виртуальным файлам в файловой системе.
Данная программа позволяет ориентироваться в том, что конкретно происходит в Linux;  
-А - выводит все процессы;  
-а - выводит все процессы в текущем терминале;  
-u - выводит процессы, запушенные пользователем root;  
-x - выводит список всех активных процессов;  
-С - выводит процессы по имени команды  

* Чтобы изменения вступили в силу необходимо перезапустить систему командой
  `sudo systemctl restart sshd`

* Выводим статус командой `systemctl status sshd`

![8-8](Screen/8-8.png)

* Результат выполнения можно увидеть введя команду `netstat -tan`.

![8-5](Screen/8-5.png)

-t отобразит только TCP;  
-a покажет все сокеты(слушаемые и нет);  
-n будет показывает численные адрес;
Proto - Содержит тип протокола;  
Recv-Q - Счётчик байтов не скопированных программой пользователя из этого сокета;  
Send-Q - Счётчик байтов, не подтверждённых удалённым узлом;  
Local Address - Адрес и номер порта локального конца сокета;  
Foreign Address - Адрес и номер порта удалённого конца сокета;  
State - Состояние сокета;  
LISTEN Сокет ожидает входящих подключений;  
SYN_SENT Сокет, находящийся в режиме активной попытки установки подключения;  
0.0.0.0 - это немаршрутизируемый адрес IPv4, который используется в качестве адреса по умолчанию или адреса-заполнителя;

## Part 9. Установка и использование утилит top, htop
* Установить и запустить утилиты top и htop
* Установка утилиты "top" выполняется командой `sudo apt install top`
* Запуск утилиты "top" производится командой `top`

![9-3](Screen/9-3.png)

В верхней части находится информация о системе, 
общем использовании ресурсов процессора и памяти, раздела подкачки, и т.д.  
В нижней части окна расположен список запущенных процессов с информацией, отсортированных по определённому полю.

* Вывод с команды `top`  
Uptime up 59 min  
Количество авторизованных пользователей 1 user  
Общую загрузку системы 0,00, 0,00, 0,00  
Общее количество процессов 106 total  
Загрузку cpu 0.0  
Загрузку памяти MiB Mem 1983,2 MiB Swap 1499,0  
Pid процесса занимающего больше всего памяти 741  
Pid процесса, занимающего больше всего процессорного времени 1root  

* Установка утилиты "htop" выполняется командой `sudo apt install htop`

![9-1](Screen/9-1.png)

* Запуск утилиты "htop" производится командой `htop`

![9-2](Screen/9-5.png)

* Для того чтбы отсортировать данные используем клавишу `F6`
* Скрины с сротировкой процессов по:
PID

![9-99](Screen/9-99.png)

PERCENT_CPU

![9-6](Screen/9-6.png)

PERCENT_MEM

![9-7](Screen/9-7.png)

TIME

![9-8](Screen/9-8.png)

Для фильтрации процесса по sshd используем клавишу меню `F4`. Вводим в сроку  Filter `sshd`.  

![9-9](Screen/9-9.png)

Для фильтрации используем клавишу меню `F3`. Вводим в сроку  Search `syslog`.

![9-22](Screen/9-22.png)

Для добавления hostname, clock и uptime нажимаем `F2` и в настройках добавляем необходимые атрибуты на дашборд утилиты.

![9-21](Screen/9-21.png)

## Part 10. Использование утилиты fdisk

* Устанавливаем утилиту командами `sudo apt update` и `sudo apt install fdisk`.
  Команда fdisk позволяет задействовать одноименную утилиту для модификации таблиц разделов жестких дисков формата MSDOS.
* Запускаем утилиту командой `sudo fdisk -l`.

![10-1](Screen/10-1.png)

название жесткого диска  /dev/sda
размер 10 G
количество секторов 20971520
размер swap с помощью команды `swapon --show`
размер swap 1.5 G

![10-3](Screen/10-3.png)

## Part 11. Использование утилиты df

* df  
Размер раздела 8408452 KB  
Размер занятого пространства 4263240 KB  
Размер свободного пространства 3696496 KB  
Процент использования 54%  

![11-1](Screen/11-1.png)

* df -Th  
Размер раздела 8,1G  
Размер занятого пространства 4,1G  
Размер свободного пространства 3,6G  
Процент использования 54%  
Тип файловой системы для раздела ext4  

![11-3](Screen/11-3.png)


## Part 12. Использование утилиты du

*Для запуска утилиты do нужно ввести команду `do`.
* Вывести размер папок /home, /var, /var/log(в байтах, в человекочитаемом виде) c использованием команды 
`sudo du -s --block-size=1 /var/log /var /home`.  
-s, --summarize - выводить только общий размер;  
-B, --block-size - указать единицы вывода размераю.

![12-01](Screen/12-01.png)

* В человекочитаемом виде используя команду `sudo du -sh /var/log /var /home`.  
-h, --human-readable - выводить размер в единицах измерения удобных для человека;

 ![12-03](Screen/12-03.png)

* Вывести размер всего содержимого в /var/log используя команду `sudo du /var/log/*`.

 ![12-02](Screen/12-02.png)


## Part 13. Установка и использование утилиты ncdu
* Установить утилиту ncdu. 
* Используем команду `sudo apt install ncdu`

 ![13-1](Screen/13-1.png)

* Вывести размер папок /home, /var, /var/log. Нужно ввести следущие команды:

  ![13-5](Screen/13-5.png)

* /home
  ![13-2](Screen/13-2.png)
* /var
  ![13-3](Screen/13-3.png)
* /var/log
  ![13-4](Screen/13-4.png)

## Part 14. Работа с системными журналами

* Для удобства воспользуемся командой `tail`, она показывает последние десять строк файла.
* /var/log/dmesg
  ![14-01](Screen/14-01.png)
* /var/log/syslog
  ![14-3](Screen/14-3.png)
* /var/log/auth.log
  ![14-1](Screen/14-1.png)

- время последней успешной авторизации 19:46:40
- имя пользователя killedhi
- метод входа в систему pam_unix
  ![14-05](Screen/14-05.png)
* Перезапустить службу SSHd `sudo service ssh restart`
  ![14-2](Screen/14-2.png)
* Вставить в отчёт скрин с сообщением о рестарте службы (искать в логах).  
Вводим команду `tail /var/log/syslog`
  ![14-06](Screen/14-06.png)


  ## Part 15. Использование планировщика заданий CRON

* Используя планировщик заданий, запустите команду uptime через каждые 2 минуты
  Вызываем `crontab -e`, выбираем редактор.  
* crontab -e	Редактирование или создание файла расписания для текущего пользователя;  
* crontab -l	Вывод содержимого расписания текущего пользователя;  
* crontab -r	Удаление файла расписания текущего пользователя;  
* crontab -u user	Работа с расписаниями конкретных пользователей.

![15-1](Screen/15-1.png)

  ![15-2](Screen/15-2.png)
  внизу под комментариями вставляем следующую строку:
`*/2 * * * * uptime | wall`
  ![15-3](Screen/15-3.png)

- строчки о выполнении
  `cat /var/log/syslog`
  ![15-01](Screen/15-01.png)

- cписок текущих заданий для CRON
  `crontab -l`

  ![15-02](Screen/15-02.png)


* Удалите все задания из планировщика заданий
  `crontab -r`
  проверить
  `crontab -l`

  ![15-03](Screen/15-03.png)


